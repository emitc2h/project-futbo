[gd_resource type="BehaviorTree" load_steps=44 format=3 uid="uid://c7vvmbp7vehqy"]

[ext_resource type="Script" uid="uid://3wp8o6jifb3l" path="res://ai/tasks/drone/drone_patrol_action.gd" id="1_128xi"]
[ext_resource type="Script" uid="uid://dhngbs7qm6328" path="res://ai/tasks/drone/is_object_in_proximity_zone_condition.gd" id="1_ckfmh"]
[ext_resource type="BlackboardPlan" uid="uid://13kdtfbmqd6l" path="res://ai/trees/enemies/drone/decision trees/drone_complete_behavior_blackboard_plan.tres" id="1_k8dvn"]
[ext_resource type="Script" uid="uid://4tpean3rpeo8" path="res://ai/tasks/drone/drone_block_action.gd" id="2_ckfmh"]
[ext_resource type="Script" uid="uid://cu1bkrkshc51d" path="res://ai/tasks/drone/update_blackboard_condition.gd" id="2_r3tiw"]
[ext_resource type="Script" uid="uid://bbbdpq3yu2mga" path="res://ai/tasks/drone/is_outside_patrol_markers_condition.gd" id="3_xekj4"]
[ext_resource type="Script" uid="uid://c3n51ki08yi4c" path="res://ai/tasks/drone/drone_track_action.gd" id="4_ckfmh"]
[ext_resource type="Script" uid="uid://brqg8vvudgc7a" path="res://ai/tasks/drone/is_in_targeting_state_condition.gd" id="4_v0ahm"]
[ext_resource type="Script" uid="uid://btr4jxosdlhew" path="res://ai/tasks/drone/drone_go_to_patrol_action.gd" id="5_xekj4"]
[ext_resource type="BehaviorTree" uid="uid://b2yl7nxa3drym" path="res://ai/trees/enemies/drone/decision trees/goals/attack_test.tres" id="7_v0ahm"]

[sub_resource type="BTCondition" id="BTCondition_664xi"]
script = ExtResource("2_r3tiw")

[sub_resource type="BTAlwaysFail" id="BTAlwaysFail_wyg27"]
custom_name = "ALWAYS UPDATE BLACKBOARD"
children = [SubResource("BTCondition_664xi")]

[sub_resource type="BBVariant" id="BBVariant_8hvrt"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BTCheckVar" id="BTCheckVar_wg5t1"]
variable = &"internal_player_repr_is_dead"
value = SubResource("BBVariant_8hvrt")

[sub_resource type="BTAction" id="BTAction_wg5t1"]
script = ExtResource("1_128xi")

[sub_resource type="BTSequence" id="BTSequence_vl0fi"]
custom_name = "IF GOAL: GO BACK TO PATROL WHEN PLAYER IS DEAD"
children = [SubResource("BTCheckVar_wg5t1"), SubResource("BTAction_wg5t1")]

[sub_resource type="BTCondition" id="BTCondition_ntcwm"]
script = ExtResource("1_ckfmh")
object_type = "Control Node"

[sub_resource type="BTAction" id="BTAction_k8dvn"]
script = ExtResource("2_ckfmh")

[sub_resource type="BBVariant" id="BBVariant_mcvek"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BTSetVar" id="BTSetVar_65x83"]
variable = &"attacking"
value = SubResource("BBVariant_mcvek")

[sub_resource type="BTSequence" id="BTSequence_v0ahm"]
custom_name = "ELIF GOAL: DEFEND"
children = [SubResource("BTCondition_ntcwm"), SubResource("BTAction_k8dvn"), SubResource("BTSetVar_65x83")]

[sub_resource type="BBVariant" id="BBVariant_664xi"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BTCheckVar" id="BTCheckVar_wyg27"]
variable = &"attacking"
value = SubResource("BBVariant_664xi")

[sub_resource type="BlackboardPlan" id="BlackboardPlan_mcvek"]

[sub_resource type="BTSubtree" id="BTSubtree_65x83"]
subtree = ExtResource("7_v0ahm")
blackboard_plan = SubResource("BlackboardPlan_mcvek")

[sub_resource type="BTSequence" id="BTSequence_wg5t1"]
custom_name = "ELIF GOAL: ATTACK"
children = [SubResource("BTCheckVar_wyg27"), SubResource("BTSubtree_65x83")]

[sub_resource type="BTCondition" id="BTCondition_vc7r2"]
script = ExtResource("4_v0ahm")
expected_state = 3

[sub_resource type="BBVariant" id="BBVariant_65x83"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BTSetVar" id="BTSetVar_r3tiw"]
variable = &"attacking"
value = SubResource("BBVariant_65x83")

[sub_resource type="BTSequence" id="BTSequence_kr7to"]
children = [SubResource("BTCondition_vc7r2"), SubResource("BTSetVar_r3tiw")]

[sub_resource type="BTCondition" id="BTCondition_ckfmh"]
script = ExtResource("4_v0ahm")
expected_state = 2

[sub_resource type="BTAction" id="BTAction_v0ahm"]
script = ExtResource("4_ckfmh")
timeout = 3.0

[sub_resource type="BBVariant" id="BBVariant_v0ahm"]
type = 1
saved_value = false
resource_name = "<null>"

[sub_resource type="BTSetVar" id="BTSetVar_mcvek"]
variable = &"attacking"
value = SubResource("BBVariant_v0ahm")

[sub_resource type="BTSequence" id="BTSequence_k8dvn"]
children = [SubResource("BTCondition_ckfmh"), SubResource("BTAction_v0ahm"), SubResource("BTSetVar_mcvek")]

[sub_resource type="BTCondition" id="BTCondition_xekj4"]
script = ExtResource("3_xekj4")
tolerance = 2.0

[sub_resource type="BTAction" id="BTAction_ckfmh"]
script = ExtResource("5_xekj4")

[sub_resource type="BTSequence" id="BTSequence_ntcwm"]
children = [SubResource("BTCondition_xekj4"), SubResource("BTAction_ckfmh")]

[sub_resource type="BTAction" id="BTAction_cx3lo"]
script = ExtResource("1_128xi")

[sub_resource type="BTSequence" id="BTSequence_nl7ey"]
children = [SubResource("BTAction_cx3lo")]

[sub_resource type="BTDynamicSelector" id="BTDynamicSelector_v0ahm"]
children = [SubResource("BTSequence_kr7to"), SubResource("BTSequence_k8dvn"), SubResource("BTSequence_ntcwm"), SubResource("BTSequence_nl7ey")]

[sub_resource type="BTDynamicSequence" id="BTDynamicSequence_v0ahm"]
custom_name = "ELSE GOAL: PATROL"
children = [SubResource("BTDynamicSelector_v0ahm")]

[sub_resource type="BTDynamicSelector" id="BTDynamicSelector_yfevx"]
custom_name = "ROOT DYNAMIC SELECTOR"
children = [SubResource("BTAlwaysFail_wyg27"), SubResource("BTSequence_vl0fi"), SubResource("BTSequence_v0ahm"), SubResource("BTSequence_wg5t1"), SubResource("BTDynamicSequence_v0ahm")]

[resource]
blackboard_plan = ExtResource("1_k8dvn")
root_task = SubResource("BTDynamicSelector_yfevx")
