[gd_resource type="BehaviorTree" load_steps=34 format=3 uid="uid://cpvyyi1eyo8ae"]

[ext_resource type="Script" uid="uid://og2wfxp7v822" path="res://ai/tasks/drone/is_in_physics_state_condition.gd" id="1_uxqot"]
[ext_resource type="Script" uid="uid://dhptod8wkftxr" path="res://ai/tasks/drone/set_physics_action.gd" id="2_g05kx"]
[ext_resource type="Script" uid="uid://bq6jhax0oj50u" path="res://ai/tasks/drone/is_in_engagement_state_condition.gd" id="3_kiqek"]
[ext_resource type="Script" uid="uid://ccb4gyv0lb1qr" path="res://ai/tasks/drone/open_action.gd" id="4_lndyf"]
[ext_resource type="Script" uid="uid://brqg8vvudgc7a" path="res://ai/tasks/drone/is_in_targeting_state_condition.gd" id="5_ab5vl"]
[ext_resource type="Script" uid="uid://c6ocf77l1pyn7" path="res://ai/tasks/drone/set_targeting_action.gd" id="6_8roe8"]
[ext_resource type="Script" uid="uid://66mhcr7w8o2f" path="res://ai/tasks/drone/face_node_action.gd" id="7_l78qf"]
[ext_resource type="Script" uid="uid://d2x8xeh13xlky" path="res://ai/tasks/drone/move_to_node_action.gd" id="8_a4j6w"]
[ext_resource type="Script" uid="uid://cjmmtaigaxfy3" path="res://ai/tasks/drone/set_engines_action.gd" id="9_o8nb2"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_w0hl5"]

[sub_resource type="BTCondition" id="BTCondition_r412u"]
script = ExtResource("1_uxqot")

[sub_resource type="BTAction" id="BTAction_f3khh"]
script = ExtResource("2_g05kx")
phys_type = "char"

[sub_resource type="BTSelector" id="BTSelector_0v7h5"]
custom_name = "Make sure drone is in CHAR mode"
children = [SubResource("BTCondition_r412u"), SubResource("BTAction_f3khh")]

[sub_resource type="BTCondition" id="BTCondition_q4kqo"]
script = ExtResource("3_kiqek")
expected_state = 2

[sub_resource type="BTAction" id="BTAction_6wgr1"]
script = ExtResource("4_lndyf")
check_signal_id = true

[sub_resource type="BTSelector" id="BTSelector_i4fuh"]
custom_name = "Make sure drone is OPEN"
children = [SubResource("BTCondition_q4kqo"), SubResource("BTAction_6wgr1")]

[sub_resource type="BTCondition" id="BTCondition_tabfr"]
script = ExtResource("5_ab5vl")
expected_state = 1

[sub_resource type="BTAction" id="BTAction_q2l2i"]
script = ExtResource("6_8roe8")
targ_type = "enabled"
enable_to_acquiring = true

[sub_resource type="BTSelector" id="BTSelector_d4j7v"]
custom_name = "Make sure targeting is ENABLED and NONE"
children = [SubResource("BTCondition_tabfr"), SubResource("BTAction_q2l2i")]

[sub_resource type="BTParallel" id="BTParallel_0pjke"]
num_successes_required = 3
custom_name = "Prepare Go to Patrol"
children = [SubResource("BTSelector_0v7h5"), SubResource("BTSelector_i4fuh"), SubResource("BTSelector_d4j7v")]

[sub_resource type="BTAction" id="BTAction_hopmd"]
script = ExtResource("6_8roe8")
targ_type = "enabled"

[sub_resource type="BBNode" id="BBNode_ii4gc"]
saved_value = NodePath("PatrolMarker1")
resource_name = "PatrolMarker1"

[sub_resource type="BTAction" id="BTAction_tmajn"]
script = ExtResource("7_l78qf")
custom_node = SubResource("BBNode_ii4gc")
world_repr_pos_x_name = "patrol_center_pos_x"
target_type = "world representation x position"

[sub_resource type="BBNode" id="BBNode_a5irl"]
saved_value = NodePath("")

[sub_resource type="BTAction" id="BTAction_mumd7"]
script = ExtResource("8_a4j6w")
custom_node = SubResource("BBNode_a5irl")
world_repr_pos_x_name = "patrol_center_pos_x"
target_type = "world representation x position"
close_enough_distance = 0.1

[sub_resource type="BTAction" id="BTAction_rlvi6"]
script = ExtResource("9_o8nb2")
eng_type = "burst"

[sub_resource type="BTWait" id="BTWait_3evvg"]

[sub_resource type="BTAction" id="BTAction_h856u"]
script = ExtResource("9_o8nb2")
eng_type = "thrust"

[sub_resource type="BTSequence" id="BTSequence_tpxh1"]
children = [SubResource("BTAction_rlvi6"), SubResource("BTWait_3evvg"), SubResource("BTAction_h856u")]

[sub_resource type="BTAlwaysFail" id="BTAlwaysFail_hhrgl"]
children = [SubResource("BTSequence_tpxh1")]

[sub_resource type="BTParallel" id="BTParallel_ef1ai"]
num_failures_required = 5
custom_name = "Move toward patrol position with initial burst"
children = [SubResource("BTAction_mumd7"), SubResource("BTAlwaysFail_hhrgl")]

[sub_resource type="BTSequence" id="BTSequence_05nq6"]
custom_name = "Go to Patrol"
children = [SubResource("BTAction_hopmd"), SubResource("BTAction_tmajn"), SubResource("BTParallel_ef1ai")]

[sub_resource type="BTSequence" id="BTSequence_o7f83"]
custom_name = "Main Sequence"
children = [SubResource("BTParallel_0pjke"), SubResource("BTSequence_05nq6")]

[resource]
blackboard_plan = SubResource("BlackboardPlan_w0hl5")
root_task = SubResource("BTSequence_o7f83")
