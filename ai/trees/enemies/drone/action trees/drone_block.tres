[gd_resource type="BehaviorTree" load_steps=30 format=3 uid="uid://pd1pmv73hmtf"]

[ext_resource type="Script" uid="uid://bq6jhax0oj50u" path="res://ai/tasks/drone/is_in_engagement_state_condition.gd" id="1_jipit"]
[ext_resource type="Script" uid="uid://bg84c7y6wffvi" path="res://ai/tasks/drone/close_action.gd" id="2_7rypo"]
[ext_resource type="Script" uid="uid://b467pd73p0l2y" path="res://ai/tasks/drone/is_in_vulnerability_state_condition.gd" id="3_3o038"]
[ext_resource type="Script" uid="uid://cetf63fmdqa02" path="res://ai/tasks/drone/set_vulnerability_action.gd" id="4_yabov"]
[ext_resource type="Script" uid="uid://cryuu1jycrokl" path="res://ai/tasks/drone/is_in_engines_state_condition.gd" id="5_w1ulr"]
[ext_resource type="Script" uid="uid://cnulieepl2f00" path="res://ai/tasks/drone/stop_moving_action.gd" id="6_d7oxy"]
[ext_resource type="Script" uid="uid://cjmmtaigaxfy3" path="res://ai/tasks/drone/set_engines_action.gd" id="7_j8cmf"]
[ext_resource type="Script" uid="uid://byp755qw4t3mv" path="res://ai/tasks/drone/wait_for_control_node_proximity_exited_action.gd" id="8_v0kad"]
[ext_resource type="Script" uid="uid://ccb4gyv0lb1qr" path="res://ai/tasks/drone/open_action.gd" id="9_3beeu"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_u838b"]

[sub_resource type="BTCondition" id="BTCondition_a3wdo"]
script = ExtResource("1_jipit")

[sub_resource type="BTCondition" id="BTCondition_n0rf2"]
script = ExtResource("1_jipit")
expected_state = 4

[sub_resource type="BTAction" id="BTAction_d6e5j"]
script = ExtResource("2_7rypo")
async = true
quick = true

[sub_resource type="BTSelector" id="BTSelector_35qjs"]
custom_name = "Make sure drone QUICK CLOSES"
children = [SubResource("BTCondition_a3wdo"), SubResource("BTCondition_n0rf2"), SubResource("BTAction_d6e5j")]

[sub_resource type="BTCondition" id="BTCondition_10kkc"]
script = ExtResource("3_3o038")

[sub_resource type="BTAction" id="BTAction_psrtj"]
script = ExtResource("4_yabov")
vuln_type = "invulnerable"

[sub_resource type="BTSelector" id="BTSelector_y4bi0"]
custom_name = "Make sure drone becomes INVULNERABLE"
children = [SubResource("BTCondition_10kkc"), SubResource("BTAction_psrtj")]

[sub_resource type="BTCondition" id="BTCondition_rbm3x"]
script = ExtResource("5_w1ulr")

[sub_resource type="BTCondition" id="BTCondition_l6oo2"]
script = ExtResource("5_w1ulr")
expected_state = 3

[sub_resource type="BTAction" id="BTAction_wuhy6"]
script = ExtResource("6_d7oxy")

[sub_resource type="BTAction" id="BTAction_wvy1b"]
script = ExtResource("7_j8cmf")
eng_type = "quick stop"

[sub_resource type="BTParallel" id="BTParallel_5y8xq"]
children = [SubResource("BTAction_wuhy6"), SubResource("BTAction_wvy1b")]

[sub_resource type="BTSelector" id="BTSelector_qc13u"]
custom_name = "Make sure engines turn OFF"
children = [SubResource("BTCondition_rbm3x"), SubResource("BTCondition_l6oo2"), SubResource("BTParallel_5y8xq")]

[sub_resource type="BTParallel" id="BTParallel_1b0sp"]
num_successes_required = 3
children = [SubResource("BTSelector_35qjs"), SubResource("BTSelector_y4bi0"), SubResource("BTSelector_qc13u")]

[sub_resource type="BTAction" id="BTAction_luccx"]
script = ExtResource("8_v0kad")

[sub_resource type="BTAction" id="BTAction_g0kfy"]
script = ExtResource("4_yabov")
vuln_type = "defendable"

[sub_resource type="BTAction" id="BTAction_y1m0k"]
script = ExtResource("9_3beeu")

[sub_resource type="BTSequence" id="BTSequence_0eqgu"]
custom_name = "Recover from BLOCK"
children = [SubResource("BTAction_luccx"), SubResource("BTAction_g0kfy"), SubResource("BTAction_y1m0k")]

[sub_resource type="BTSequence" id="BTSequence_2exah"]
custom_name = "Main Sequence"
children = [SubResource("BTParallel_1b0sp"), SubResource("BTSequence_0eqgu")]

[resource]
blackboard_plan = SubResource("BlackboardPlan_u838b")
root_task = SubResource("BTSequence_2exah")
